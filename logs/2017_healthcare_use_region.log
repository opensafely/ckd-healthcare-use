-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/2017_healthcare_use_region.log
  log type:  text
 opened on:  22 Feb 2023, 18:09:50

. cap file close tablecontent

. **Creates output file for each year (`dataset')
. file open tablecontent using ./output/`dataset'_healthcare_use_region.csv, wr
> ite text replace
(note: file ./output/2017_healthcare_use_region.csv not found)

. **Column headings
. *Measures of each outcome by month
. *Column n_`dataset' is the total number in each CKD group as of the beginning
>  of April of each year
. file write tablecontent _tab _tab ("n_`dataset'") _tab ("April") _tab ("May")
>  _tab ("June") _tab ("July") _tab ("August") _tab ("September") _tab ("Octobe
> r") _tab ("November") _tab ("December") _tab ("January") _tab ("February") _t
> ab ("March") _n(2)

. use ./output/`dataset'_ckd_complete.dta, clear

. 
. **For code development from dummy data
. /*
> cap file close tablecontent
> file open tablecontent using ./output/2017_healthcare_use_region.csv, write t
> ext replace
> file write tablecontent _tab _tab ("n_2017'") _tab ("April") _tab ("May") _ta
> b ("June") _tab ("July") _tab ("August") _tab ("September") _tab ("October") 
> _tab ("November") _tab ("December") _tab ("January") _tab ("February") _tab (
> "March") _n(2)
> use ./output/2017_ckd_complete.dta, clear
> */
. forvalues region = 1/9 {
  2. use ./output/`dataset'_ckd_complete.dta, clear
  3. drop if region !=`region'
  4. qui safecount
  5. local baseline_ckd = round(r(N),5)
  6. foreach binary of varlist m4_admitted_patients m5_admitted_patients m6_adm
> itted_patients m7_admitted_patients m8_admitted_patients m9_admitted_patients
>  m10_admitted_patients m11_admitted_patients m12_admitted_patients m1_admitte
> d_patients m2_admitted_patients m3_admitted_patients m4_fistula_formation m5_
> fistula_formation m6_fistula_formation m7_fistula_formation m8_fistula_format
> ion m9_fistula_formation m10_fistula_formation m11_fistula_formation m12_fist
> ula_formation m1_fistula_formation m2_fistula_formation m3_fistula_formation 
> m4_pd_insertion m5_pd_insertion m6_pd_insertion m7_pd_insertion m8_pd_inserti
> on m9_pd_insertion m10_pd_insertion m11_pd_insertion m12_pd_insertion m1_pd_i
> nsertion m2_pd_insertion m3_pd_insertion m4_critical_care_patients m5_critica
> l_care_patients m6_critical_care_patients m7_critical_care_patients m8_critic
> al_care_patients m9_critical_care_patients m10_critical_care_patients m11_cri
> tical_care_patients m12_critical_care_patients m1_critical_care_patients m2_c
> ritical_care_patients m3_critical_care_patients m4_blood_pressure m5_blood_pr
> essure m6_blood_pressure m7_blood_pressure m8_blood_pressure m9_blood_pressur
> e m10_blood_pressure m11_blood_pressure m12_blood_pressure m1_blood_pressure 
> m2_blood_pressure m3_blood_pressure m4_albuminuria m5_albuminuria m6_albuminu
> ria m7_albuminuria m8_albuminuria m9_albuminuria m10_albuminuria m11_albuminu
> ria m12_albuminuria m1_albuminuria m2_albuminuria m3_albuminuria m4_creatinin
> e m5_creatinine m6_creatinine m7_creatinine m8_creatinine m9_creatinine m10_c
> reatinine m11_creatinine m12_creatinine m1_creatinine m2_creatinine m3_creati
> nine {
  7. *Number of people in each CKD group coded for each binary measure each mon
> th
. qui safecount if `binary'==1
  8. local ckd_`binary' = round(r(N),5)
  9. }
 10. foreach aggregate of varlist m4_hospital_days m5_hospital_days m6_hospital
> _days m7_hospital_days m8_hospital_days m9_hospital_days m10_hospital_days m1
> 1_hospital_days m12_hospital_days m1_hospital_days m2_hospital_days m3_hospit
> al_days m4_critical_care_days m5_critical_care_days m6_critical_care_days m7_
> critical_care_days m8_critical_care_days m9_critical_care_days m10_critical_c
> are_days m11_critical_care_days m12_critical_care_days m1_critical_care_days 
> m2_critical_care_days m3_critical_care_days m4_emergency_days m5_emergency_da
> ys m6_emergency_days m7_emergency_days m8_emergency_days m9_emergency_days m1
> 0_emergency_days m11_emergency_days m12_emergency_days m1_emergency_days m2_e
> mergency_days m3_emergency_days m4_op_appts m5_op_appts m6_op_appts m7_op_app
> ts m8_op_appts m9_op_appts m10_op_appts m11_op_appts m12_op_appts m1_op_appts
>  m2_op_appts m3_op_appts m4_neph_appts m5_neph_appts m6_neph_appts m7_neph_ap
> pts m8_neph_appts m9_neph_appts m10_neph_appts m11_neph_appts m12_neph_appts 
> m1_neph_appts m2_neph_appts m3_neph_appts m4_tx_appts m5_tx_appts m6_tx_appts
>  m7_tx_appts m8_tx_appts m9_tx_appts m10_tx_appts m11_tx_appts m12_tx_appts m
> 1_tx_appts m2_tx_appts m3_tx_appts m4_gp_interactions m5_gp_interactions m6_g
> p_interactions m7_gp_interactions m8_gp_interactions m9_gp_interactions m10_g
> p_interactions m11_gp_interactions m12_gp_interactions m1_gp_interactions m2_
> gp_interactions m3_gp_interactions {
 11. qui su overall_`aggregate'
 12. local ckd_`aggregate' = r(mean)
 13. }
 14. local lab0: label region `region'
 15. file write tablecontent ("`lab0'") _n(2)
 16. file write tablecontent ("All CKD groups") _tab _tab (`baseline_ckd') _n
 17. file write tablecontent _tab ("Hospital days") _tab _tab (`ckd_m4_hospital
> _days') _tab (`ckd_m5_hospital_days') _tab (`ckd_m6_hospital_days') _tab (`ck
> d_m7_hospital_days') _tab (`ckd_m8_hospital_days') _tab (`ckd_m9_hospital_day
> s') _tab (`ckd_m10_hospital_days') _tab (`ckd_m11_hospital_days') _tab (`ckd_
> m12_hospital_days') _tab (`ckd_m1_hospital_days') _tab (`ckd_m2_hospital_days
> ') _tab (`ckd_m3_hospital_days') _n
 18. file write tablecontent _tab ("Hospitalised patients") _tab _tab (`ckd_m4_
> admitted_patients') _tab (`ckd_m5_admitted_patients') _tab (`ckd_m6_admitted_
> patients') _tab (`ckd_m7_admitted_patients') _tab (`ckd_m8_admitted_patients'
> ) _tab (`ckd_m9_admitted_patients') _tab (`ckd_m10_admitted_patients') _tab (
> `ckd_m11_admitted_patients') _tab (`ckd_m12_admitted_patients') _tab (`ckd_m1
> _admitted_patients') _tab (`ckd_m2_admitted_patients') _tab (`ckd_m3_admitted
> _patients') _n
 19. file write tablecontent _tab ("AVF formations") _tab _tab (`ckd_m4_fistula
> _formation') _tab (`ckd_m5_fistula_formation') _tab (`ckd_m6_fistula_formatio
> n') _tab (`ckd_m7_fistula_formation') _tab (`ckd_m8_fistula_formation') _tab 
> (`ckd_m9_fistula_formation') _tab (`ckd_m10_fistula_formation') _tab (`ckd_m1
> 1_fistula_formation') _tab (`ckd_m12_fistula_formation') _tab (`ckd_m1_fistul
> a_formation') _tab (`ckd_m2_fistula_formation') _tab (`ckd_m3_fistula_formati
> on') _n
 20. file write tablecontent _tab ("PD insertions") _tab _tab (`ckd_m4_pd_inser
> tion') _tab (`ckd_m5_pd_insertion') _tab (`ckd_m6_pd_insertion') _tab (`ckd_m
> 7_pd_insertion') _tab (`ckd_m8_pd_insertion') _tab (`ckd_m9_pd_insertion') _t
> ab (`ckd_m10_pd_insertion') _tab (`ckd_m11_pd_insertion') _tab (`ckd_m12_pd_i
> nsertion') _tab (`ckd_m1_pd_insertion') _tab (`ckd_m2_pd_insertion') _tab (`c
> kd_m3_pd_insertion') _n
 21. file write tablecontent _tab ("ICU days") _tab _tab (`ckd_m4_critical_care
> _days') _tab (`ckd_m5_critical_care_days') _tab (`ckd_m6_critical_care_days')
>  _tab (`ckd_m7_critical_care_days') _tab (`ckd_m8_critical_care_days') _tab (
> `ckd_m9_critical_care_days') _tab (`ckd_m10_critical_care_days') _tab (`ckd_m
> 11_critical_care_days') _tab (`ckd_m12_critical_care_days') _tab (`ckd_m1_cri
> tical_care_days') _tab (`ckd_m2_critical_care_days') _tab (`ckd_m3_critical_c
> are_days') _n
 22. file write tablecontent _tab ("ICU patients") _tab _tab (`ckd_m4_critical_
> care_patients') _tab (`ckd_m5_critical_care_patients') _tab (`ckd_m6_critical
> _care_patients') _tab (`ckd_m7_critical_care_patients') _tab (`ckd_m8_critica
> l_care_patients') _tab (`ckd_m9_critical_care_patients') _tab (`ckd_m10_criti
> cal_care_patients') _tab (`ckd_m11_critical_care_patients') _tab (`ckd_m12_cr
> itical_care_patients') _tab (`ckd_m1_critical_care_patients') _tab (`ckd_m2_c
> ritical_care_patients') _tab (`ckd_m3_critical_care_patients') _n
 23. file write tablecontent _tab ("ED days") _tab _tab (`ckd_m4_emergency_days
> ') _tab (`ckd_m5_emergency_days') _tab (`ckd_m6_emergency_days') _tab (`ckd_m
> 7_emergency_days') _tab (`ckd_m8_emergency_days') _tab (`ckd_m9_emergency_day
> s') _tab (`ckd_m10_emergency_days') _tab (`ckd_m11_emergency_days') _tab (`ck
> d_m12_emergency_days') _tab (`ckd_m1_emergency_days') _tab (`ckd_m2_emergency
> _days') _tab (`ckd_m3_emergency_days') _n
 24. file write tablecontent _tab ("OPD appts") _tab _tab (`ckd_m4_op_appts') _
> tab (`ckd_m5_op_appts') _tab (`ckd_m6_op_appts') _tab (`ckd_m7_op_appts') _ta
> b (`ckd_m8_op_appts') _tab (`ckd_m9_op_appts') _tab (`ckd_m10_op_appts') _tab
>  (`ckd_m11_op_appts') _tab (`ckd_m12_op_appts') _tab (`ckd_m1_op_appts') _tab
>  (`ckd_m2_op_appts') _tab (`ckd_m3_op_appts') _n
 25. file write tablecontent _tab ("Neph appts") _tab _tab (`ckd_m4_neph_appts'
> ) _tab (`ckd_m5_neph_appts') _tab (`ckd_m6_neph_appts') _tab (`ckd_m7_neph_ap
> pts') _tab (`ckd_m8_neph_appts') _tab (`ckd_m9_neph_appts') _tab (`ckd_m10_ne
> ph_appts') _tab (`ckd_m11_neph_appts') _tab (`ckd_m12_neph_appts') _tab (`ckd
> _m1_neph_appts') _tab (`ckd_m2_neph_appts') _tab (`ckd_m3_neph_appts') _n
 26. file write tablecontent _tab ("Tx appts") _tab _tab (`ckd_m4_tx_appts') _t
> ab (`ckd_m5_tx_appts') _tab (`ckd_m6_tx_appts') _tab (`ckd_m7_tx_appts') _tab
>  (`ckd_m8_tx_appts') _tab (`ckd_m9_tx_appts') _tab (`ckd_m10_tx_appts') _tab 
> (`ckd_m11_tx_appts') _tab (`ckd_m12_tx_appts') _tab (`ckd_m1_tx_appts') _tab 
> (`ckd_m2_tx_appts') _tab (`ckd_m3_tx_appts') _n
 27. file write tablecontent _tab ("GP interactions") _tab _tab (`ckd_m4_gp_int
> eractions') _tab (`ckd_m5_gp_interactions') _tab (`ckd_m6_gp_interactions') _
> tab (`ckd_m7_gp_interactions') _tab (`ckd_m8_gp_interactions') _tab (`ckd_m9_
> gp_interactions') _tab (`ckd_m10_gp_interactions') _tab (`ckd_m11_gp_interact
> ions') _tab (`ckd_m12_gp_interactions') _tab (`ckd_m1_gp_interactions') _tab 
> (`ckd_m2_gp_interactions') _tab (`ckd_m3_gp_interactions') _n
 28. file write tablecontent _tab ("BP patients") _tab _tab (`ckd_m4_blood_pres
> sure') _tab (`ckd_m5_blood_pressure') _tab (`ckd_m6_blood_pressure') _tab (`c
> kd_m7_blood_pressure') _tab (`ckd_m8_blood_pressure') _tab (`ckd_m9_blood_pre
> ssure') _tab (`ckd_m10_blood_pressure') _tab (`ckd_m11_blood_pressure') _tab 
> (`ckd_m12_blood_pressure') _tab (`ckd_m1_blood_pressure') _tab (`ckd_m2_blood
> _pressure') _tab (`ckd_m3_blood_pressure') _n
 29. file write tablecontent _tab ("uACR patients") _tab _tab (`ckd_m4_albuminu
> ria') _tab (`ckd_m5_albuminuria') _tab (`ckd_m6_albuminuria') _tab (`ckd_m7_a
> lbuminuria') _tab (`ckd_m8_albuminuria') _tab (`ckd_m9_albuminuria') _tab (`c
> kd_m10_albuminuria') _tab (`ckd_m11_albuminuria') _tab (`ckd_m12_albuminuria'
> ) _tab (`ckd_m1_albuminuria') _tab (`ckd_m2_albuminuria') _tab (`ckd_m3_album
> inuria') _n
 30. file write tablecontent _tab ("SCr patients") _tab _tab (`ckd_m4_creatinin
> e') _tab (`ckd_m5_creatinine') _tab (`ckd_m6_creatinine') _tab (`ckd_m7_creat
> inine') _tab (`ckd_m8_creatinine') _tab (`ckd_m9_creatinine') _tab (`ckd_m10_
> creatinine') _tab (`ckd_m11_creatinine') _tab (`ckd_m12_creatinine') _tab (`c
> kd_m1_creatinine') _tab (`ckd_m2_creatinine') _tab (`ckd_m3_creatinine') _n(2
> )
 31. 
. 
. **Extract healthcare use measures by CKD group
. *CKD group categories:
. *1 = eGFR >60 with albuminuria
. *2 = CKD 3A
. *3 = CKD 4/5 without kidney replacement therapy
. *4 = Dialysis
. *5 = Kidney transplant
. *6 = Kidney replacement therapy unknown modality
. forvalues cat = 1/6 {
 32. *Disclosure minimisation:
. *safecount provides a count with any counts <=5 returned at "<=5"
. *round(r(N),5) rounds counts to the nearest 5 with any counts <=5 returned as
>  "."
. qui safecount if ckd_group==`cat'
 33. local baseline_ckd`cat' = round(r(N),5)
 34. *Monthly resources measures through financial year:
. *m4 = April, m5 = May... m1 = January of subsequent year
. foreach binary of varlist m4_admitted_patients m5_admitted_patients m6_admitt
> ed_patients m7_admitted_patients m8_admitted_patients m9_admitted_patients m1
> 0_admitted_patients m11_admitted_patients m12_admitted_patients m1_admitted_p
> atients m2_admitted_patients m3_admitted_patients m4_fistula_formation m5_fis
> tula_formation m6_fistula_formation m7_fistula_formation m8_fistula_formation
>  m9_fistula_formation m10_fistula_formation m11_fistula_formation m12_fistula
> _formation m1_fistula_formation m2_fistula_formation m3_fistula_formation m4_
> pd_insertion m5_pd_insertion m6_pd_insertion m7_pd_insertion m8_pd_insertion 
> m9_pd_insertion m10_pd_insertion m11_pd_insertion m12_pd_insertion m1_pd_inse
> rtion m2_pd_insertion m3_pd_insertion m4_critical_care_patients m5_critical_c
> are_patients m6_critical_care_patients m7_critical_care_patients m8_critical_
> care_patients m9_critical_care_patients m10_critical_care_patients m11_critic
> al_care_patients m12_critical_care_patients m1_critical_care_patients m2_crit
> ical_care_patients m3_critical_care_patients m4_blood_pressure m5_blood_press
> ure m6_blood_pressure m7_blood_pressure m8_blood_pressure m9_blood_pressure m
> 10_blood_pressure m11_blood_pressure m12_blood_pressure m1_blood_pressure m2_
> blood_pressure m3_blood_pressure m4_albuminuria m5_albuminuria m6_albuminuria
>  m7_albuminuria m8_albuminuria m9_albuminuria m10_albuminuria m11_albuminuria
>  m12_albuminuria m1_albuminuria m2_albuminuria m3_albuminuria m4_creatinine m
> 5_creatinine m6_creatinine m7_creatinine m8_creatinine m9_creatinine m10_crea
> tinine m11_creatinine m12_creatinine m1_creatinine m2_creatinine m3_creatinin
> e {
 35. *Number of people in each CKD group coded for each binary measure each mon
> th
. qui safecount if ckd_group==`cat' & `binary'==1
 36. local ckd`cat'_`binary' = round(r(N),5)
 37. }
 38. foreach aggregate of varlist m4_hospital_days m5_hospital_days m6_hospital
> _days m7_hospital_days m8_hospital_days m9_hospital_days m10_hospital_days m1
> 1_hospital_days m12_hospital_days m1_hospital_days m2_hospital_days m3_hospit
> al_days m4_critical_care_days m5_critical_care_days m6_critical_care_days m7_
> critical_care_days m8_critical_care_days m9_critical_care_days m10_critical_c
> are_days m11_critical_care_days m12_critical_care_days m1_critical_care_days 
> m2_critical_care_days m3_critical_care_days m4_emergency_days m5_emergency_da
> ys m6_emergency_days m7_emergency_days m8_emergency_days m9_emergency_days m1
> 0_emergency_days m11_emergency_days m12_emergency_days m1_emergency_days m2_e
> mergency_days m3_emergency_days m4_op_appts m5_op_appts m6_op_appts m7_op_app
> ts m8_op_appts m9_op_appts m10_op_appts m11_op_appts m12_op_appts m1_op_appts
>  m2_op_appts m3_op_appts m4_neph_appts m5_neph_appts m6_neph_appts m7_neph_ap
> pts m8_neph_appts m9_neph_appts m10_neph_appts m11_neph_appts m12_neph_appts 
> m1_neph_appts m2_neph_appts m3_neph_appts m4_tx_appts m5_tx_appts m6_tx_appts
>  m7_tx_appts m8_tx_appts m9_tx_appts m10_tx_appts m11_tx_appts m12_tx_appts m
> 1_tx_appts m2_tx_appts m3_tx_appts m4_gp_interactions m5_gp_interactions m6_g
> p_interactions m7_gp_interactions m8_gp_interactions m9_gp_interactions m10_g
> p_interactions m11_gp_interactions m12_gp_interactions m1_gp_interactions m2_
> gp_interactions m3_gp_interactions {
 39. qui su total_`aggregate' if ckd_group==`cat'
 40. local ckd`cat'_`aggregate' = r(mean)
 41. }
 42. 
. local lab1: label ckd_group 1
 43. local lab2: label ckd_group 2
 44. local lab3: label ckd_group 3
 45. local lab4: label ckd_group 4
 46. local lab5: label ckd_group 5
 47. local lab6: label ckd_group 6
 48. 
. **Populate table for each CKD group with redacted counts
. file write tablecontent ("`lab`cat''") _tab _tab (`baseline_ckd`cat'') _n
 49. file write tablecontent _tab ("Hospital days") _tab _tab (`ckd`cat'_m4_hos
> pital_days') _tab (`ckd`cat'_m5_hospital_days') _tab (`ckd`cat'_m6_hospital_d
> ays') _tab (`ckd`cat'_m7_hospital_days') _tab (`ckd`cat'_m8_hospital_days') _
> tab (`ckd`cat'_m9_hospital_days') _tab (`ckd`cat'_m10_hospital_days') _tab (`
> ckd`cat'_m11_hospital_days') _tab (`ckd`cat'_m12_hospital_days') _tab (`ckd`c
> at'_m1_hospital_days') _tab (`ckd`cat'_m2_hospital_days') _tab (`ckd`cat'_m3_
> hospital_days') _n
 50. file write tablecontent _tab ("Hospitalised patients") _tab _tab (`ckd`cat
> '_m4_admitted_patients') _tab (`ckd`cat'_m5_admitted_patients') _tab (`ckd`ca
> t'_m6_admitted_patients') _tab (`ckd`cat'_m7_admitted_patients') _tab (`ckd`c
> at'_m8_admitted_patients') _tab (`ckd`cat'_m9_admitted_patients') _tab (`ckd`
> cat'_m10_admitted_patients') _tab (`ckd`cat'_m11_admitted_patients') _tab (`c
> kd`cat'_m12_admitted_patients') _tab (`ckd`cat'_m1_admitted_patients') _tab (
> `ckd`cat'_m2_admitted_patients') _tab (`ckd`cat'_m3_admitted_patients') _n
 51. file write tablecontent _tab ("AVF formations") _tab _tab (`ckd`cat'_m4_fi
> stula_formation') _tab (`ckd`cat'_m5_fistula_formation') _tab (`ckd`cat'_m6_f
> istula_formation') _tab (`ckd`cat'_m7_fistula_formation') _tab (`ckd`cat'_m8_
> fistula_formation') _tab (`ckd`cat'_m9_fistula_formation') _tab (`ckd`cat'_m1
> 0_fistula_formation') _tab (`ckd`cat'_m11_fistula_formation') _tab (`ckd`cat'
> _m12_fistula_formation') _tab (`ckd`cat'_m1_fistula_formation') _tab (`ckd`ca
> t'_m2_fistula_formation') _tab (`ckd`cat'_m3_fistula_formation') _n
 52. file write tablecontent _tab ("PD insertions") _tab _tab (`ckd`cat'_m4_pd_
> insertion') _tab (`ckd`cat'_m5_pd_insertion') _tab (`ckd`cat'_m6_pd_insertion
> ') _tab (`ckd`cat'_m7_pd_insertion') _tab (`ckd`cat'_m8_pd_insertion') _tab (
> `ckd`cat'_m9_pd_insertion') _tab (`ckd`cat'_m10_pd_insertion') _tab (`ckd`cat
> '_m11_pd_insertion') _tab (`ckd`cat'_m12_pd_insertion') _tab (`ckd`cat'_m1_pd
> _insertion') _tab (`ckd`cat'_m2_pd_insertion') _tab (`ckd`cat'_m3_pd_insertio
> n') _n
 53. file write tablecontent _tab ("ICU days") _tab _tab (`ckd`cat'_m4_critical
> _care_days') _tab (`ckd`cat'_m5_critical_care_days') _tab (`ckd`cat'_m6_criti
> cal_care_days') _tab (`ckd`cat'_m7_critical_care_days') _tab (`ckd`cat'_m8_cr
> itical_care_days') _tab (`ckd`cat'_m9_critical_care_days') _tab (`ckd`cat'_m1
> 0_critical_care_days') _tab (`ckd`cat'_m11_critical_care_days') _tab (`ckd`ca
> t'_m12_critical_care_days') _tab (`ckd`cat'_m1_critical_care_days') _tab (`ck
> d`cat'_m2_critical_care_days') _tab (`ckd`cat'_m3_critical_care_days') _n
 54. file write tablecontent _tab ("ICU patients") _tab _tab (`ckd`cat'_m4_crit
> ical_care_patients') _tab (`ckd`cat'_m5_critical_care_patients') _tab (`ckd`c
> at'_m6_critical_care_patients') _tab (`ckd`cat'_m7_critical_care_patients') _
> tab (`ckd`cat'_m8_critical_care_patients') _tab (`ckd`cat'_m9_critical_care_p
> atients') _tab (`ckd`cat'_m10_critical_care_patients') _tab (`ckd`cat'_m11_cr
> itical_care_patients') _tab (`ckd`cat'_m12_critical_care_patients') _tab (`ck
> d`cat'_m1_critical_care_patients') _tab (`ckd`cat'_m2_critical_care_patients'
> ) _tab (`ckd`cat'_m3_critical_care_patients') _n
 55. file write tablecontent _tab ("ED days") _tab _tab (`ckd`cat'_m4_emergency
> _days') _tab (`ckd`cat'_m5_emergency_days') _tab (`ckd`cat'_m6_emergency_days
> ') _tab (`ckd`cat'_m7_emergency_days') _tab (`ckd`cat'_m8_emergency_days') _t
> ab (`ckd`cat'_m9_emergency_days') _tab (`ckd`cat'_m10_emergency_days') _tab (
> `ckd`cat'_m11_emergency_days') _tab (`ckd`cat'_m12_emergency_days') _tab (`ck
> d`cat'_m1_emergency_days') _tab (`ckd`cat'_m2_emergency_days') _tab (`ckd`cat
> '_m3_emergency_days') _n
 56. file write tablecontent _tab ("OPD appts") _tab _tab (`ckd`cat'_m4_op_appt
> s') _tab (`ckd`cat'_m5_op_appts') _tab (`ckd`cat'_m6_op_appts') _tab (`ckd`ca
> t'_m7_op_appts') _tab (`ckd`cat'_m8_op_appts') _tab (`ckd`cat'_m9_op_appts') 
> _tab (`ckd`cat'_m10_op_appts') _tab (`ckd`cat'_m11_op_appts') _tab (`ckd`cat'
> _m12_op_appts') _tab (`ckd`cat'_m1_op_appts') _tab (`ckd`cat'_m2_op_appts') _
> tab (`ckd`cat'_m3_op_appts') _n
 57. file write tablecontent _tab ("Neph appts") _tab _tab (`ckd`cat'_m4_neph_a
> ppts') _tab (`ckd`cat'_m5_neph_appts') _tab (`ckd`cat'_m6_neph_appts') _tab (
> `ckd`cat'_m7_neph_appts') _tab (`ckd`cat'_m8_neph_appts') _tab (`ckd`cat'_m9_
> neph_appts') _tab (`ckd`cat'_m10_neph_appts') _tab (`ckd`cat'_m11_neph_appts'
> ) _tab (`ckd`cat'_m12_neph_appts') _tab (`ckd`cat'_m1_neph_appts') _tab (`ckd
> `cat'_m2_neph_appts') _tab (`ckd`cat'_m3_neph_appts') _n
 58. file write tablecontent _tab ("Tx appts") _tab _tab (`ckd`cat'_m4_tx_appts
> ') _tab (`ckd`cat'_m5_tx_appts') _tab (`ckd`cat'_m6_tx_appts') _tab (`ckd`cat
> '_m7_tx_appts') _tab (`ckd`cat'_m8_tx_appts') _tab (`ckd`cat'_m9_tx_appts') _
> tab (`ckd`cat'_m10_tx_appts') _tab (`ckd`cat'_m11_tx_appts') _tab (`ckd`cat'_
> m12_tx_appts') _tab (`ckd`cat'_m1_tx_appts') _tab (`ckd`cat'_m2_tx_appts') _t
> ab (`ckd`cat'_m3_tx_appts') _n
 59. file write tablecontent _tab ("GP interactions") _tab _tab (`ckd`cat'_m4_g
> p_interactions') _tab (`ckd`cat'_m5_gp_interactions') _tab (`ckd`cat'_m6_gp_i
> nteractions') _tab (`ckd`cat'_m7_gp_interactions') _tab (`ckd`cat'_m8_gp_inte
> ractions') _tab (`ckd`cat'_m9_gp_interactions') _tab (`ckd`cat'_m10_gp_intera
> ctions') _tab (`ckd`cat'_m11_gp_interactions') _tab (`ckd`cat'_m12_gp_interac
> tions') _tab (`ckd`cat'_m1_gp_interactions') _tab (`ckd`cat'_m2_gp_interactio
> ns') _tab (`ckd`cat'_m3_gp_interactions') _n
 60. file write tablecontent _tab ("BP patients") _tab _tab (`ckd`cat'_m4_blood
> _pressure') _tab (`ckd`cat'_m5_blood_pressure') _tab (`ckd`cat'_m6_blood_pres
> sure') _tab (`ckd`cat'_m7_blood_pressure') _tab (`ckd`cat'_m8_blood_pressure'
> ) _tab (`ckd`cat'_m9_blood_pressure') _tab (`ckd`cat'_m10_blood_pressure') _t
> ab (`ckd`cat'_m11_blood_pressure') _tab (`ckd`cat'_m12_blood_pressure') _tab 
> (`ckd`cat'_m1_blood_pressure') _tab (`ckd`cat'_m2_blood_pressure') _tab (`ckd
> `cat'_m3_blood_pressure') _n
 61. file write tablecontent _tab ("uACR patients") _tab _tab (`ckd`cat'_m4_alb
> uminuria') _tab (`ckd`cat'_m5_albuminuria') _tab (`ckd`cat'_m6_albuminuria') 
> _tab (`ckd`cat'_m7_albuminuria') _tab (`ckd`cat'_m8_albuminuria') _tab (`ckd`
> cat'_m9_albuminuria') _tab (`ckd`cat'_m10_albuminuria') _tab (`ckd`cat'_m11_a
> lbuminuria') _tab (`ckd`cat'_m12_albuminuria') _tab (`ckd`cat'_m1_albuminuria
> ') _tab (`ckd`cat'_m2_albuminuria') _tab (`ckd`cat'_m3_albuminuria') _n
 62. file write tablecontent _tab ("SCr patients") _tab _tab (`ckd`cat'_m4_crea
> tinine') _tab (`ckd`cat'_m5_creatinine') _tab (`ckd`cat'_m6_creatinine') _tab
>  (`ckd`cat'_m7_creatinine') _tab (`ckd`cat'_m8_creatinine') _tab (`ckd`cat'_m
> 9_creatinine') _tab (`ckd`cat'_m10_creatinine') _tab (`ckd`cat'_m11_creatinin
> e') _tab (`ckd`cat'_m12_creatinine') _tab (`ckd`cat'_m1_creatinine') _tab (`c
> kd`cat'_m2_creatinine') _tab (`ckd`cat'_m3_creatinine') _n(2)
 63. }
 64. }
(1,841 observations deleted)
(1,884 observations deleted)
(1,664 observations deleted)
(1,854 observations deleted)
(1,870 observations deleted)
(1,878 observations deleted)
(1,872 observations deleted)
(1,856 observations deleted)
(1,897 observations deleted)

. file close tablecontent

. 
. 
. **Redact counts of 0 from each column in table (adapted from code by Emily He
> rrett)
. import delimited ./output/`dataset'_healthcare_use_region.csv, clear
(15 vars, 954 obs)

. local columns " "n_`dataset'" "april" "may" "june" "july" "august" "september
> " "october" "november" "december" "january" "february" "march" "april" "

. foreach col in `columns' {
  2. replace `col'=. if `col'<=5
  3. }
(2 real changes made, 2 to missing)
(215 real changes made, 215 to missing)
(211 real changes made, 211 to missing)
(200 real changes made, 200 to missing)
(224 real changes made, 224 to missing)
(222 real changes made, 222 to missing)
(213 real changes made, 213 to missing)
(221 real changes made, 221 to missing)
(229 real changes made, 229 to missing)
(230 real changes made, 230 to missing)
(231 real changes made, 231 to missing)
(237 real changes made, 237 to missing)
(206 real changes made, 206 to missing)
(0 real changes made)

. export delimited "./output/`dataset'_healthcare_use_region.csv", replace
(note: file ./output/2017_healthcare_use_region.csv not found)
file ./output/2017_healthcare_use_region.csv saved

. /*
> import delimited ./output/2017_healthcare_use_region.csv, clear
> local columns " "n_2017" "april" "may" "june" "july" "august" "september" "oc
> tober" "november" "december" "january" "february" "march" "april" "
> foreach col in `columns' {
> replace `col'=. if `col'<=5
> }
> export delimited "./output/2017_healthcare_use_region.csv", replace
> */
. 
end of do-file

. . file open output using "/tmp/healthcare_use_region.do.EtBe.out", write text
>  replace

. . file write output "success" 

. . file close output

. 
end of do-file


